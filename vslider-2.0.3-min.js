/*  
 * vSlider 2.0.3 
 * dynamic slideshow / carousel plugin
 * requires : modernizr 2.0.6+ and jquery 1.7+ 
 * usage : $( element ).vSlider( options ); 
*/  

(function(a){a.fn.vSlider=function(p){var f=a.extend({itemsperslide:1,spacing:0,auto:0,title:false,desc:false,divider:false,orientation:"horizontal",transition:"slide",duration:350},p);var o=this.find(".vslider");var l=o.find(".item");var m=o.find(".item").length;var q=Math.ceil(m/f.itemsperslide);var j=o.find(".navigation").width();var k=o.find(".navigation").height();var n=q*j;var h=q*k;var b=0;var i,e,c,g;function d(){if(o.find(".small").length){o.find(".thumb").each(function(v){a(this).css("cssText","background:url("+a(this).find(".small").attr("src").replace(/ /g,"%20").replace(/'/g,"%27").replace("(","%28").replace(")","%29")+") no-repeat 50% 50% #FFF")})}if(f.itemsperslide>1){for(var s=0;s<m;s+=f.itemsperslide){l.slice(s,s+f.itemsperslide).wrapAll("<div class='thumbs'></div>")}}o.find(".prev").live("click",function(v){v.preventDefault();b--;if(b<0){b=q-1}o.find(".page:eq("+b+")").click();u()});o.find(".next").live("click",function(v){v.preventDefault();b++;if(b>=q){b=0}o.find(".page:eq("+b+")").click();u()});function r(){(o.find(".next-pane").length)?o.find(".next-pane").click():o.find(".next").click()}function u(){if(f.auto>0){clearTimeout(t);t=setTimeout(r,f.auto)}}if(f.auto>0){var t=setTimeout(r,f.auto)}o.find(".next-pane").live("click",function(){e=0;o.find(".thumb.active").parent().next().find(".thumb").click();if(i==1){o.find(".next").click();if(g==1){o.find(".thumb:first").click();g=0}else{o.find(".thumb.active").parents(".thumbs").next().find(".thumb:first").click()}i=0}(o.find(".thumbs:last .thumb:last").hasClass("active"))?g=1:g=0;o.find(".thumbs").each(function(){if(a(".thumb:last",this).hasClass("active")){i=1}});u()});o.find(".prev-pane").live("click",function(){i=0;o.find(".thumb.active").parent().prev().find(".thumb").click();if(e==1){o.find(".prev").click();if(c==1){o.find(".thumb:last").click();c=0}else{o.find(".thumb.active").parents(".thumbs").prev().find(".thumb:last").click()}e=0}(o.find(".thumbs:first .thumb:first").hasClass("active"))?c=1:c=0;o.find(".thumbs").each(function(){if(a(".thumb:first",this).hasClass("active")){e=1}});u()});if(o.find(".img-pane").length){o.find(".thumb").each(function(){a("<div/>").addClass("big-img").css("cssText","background:url("+a(this).find("img").attr("url").replace(/ /g,"%20").replace(/'/g,"%27").replace("(","%28").replace(")","%29")+") no-repeat 50% 50%").appendTo(".main-img")});o.find(".thumb").live("click",function(w){w.preventDefault();var v=o.find(".thumb").index(this);a(this).parents(".controls").prev().find(".main-img .big-img").fadeOut(f.duration);a(this).parents(".controls").prev().find(".main-img .big-img:eq("+v+")").fadeIn(f.duration);if(f.title==true){o.find(".info-pane h2").html(a(this).find("img").attr("title"))}if(f.desc==true){o.find(".info-pane span").html(a(this).find("img").attr("desc"))}o.find(".thumb").removeClass("active");o.find(".item").removeClass("active");a(this).addClass("active");a(this).parent().addClass("active");u()})}if(o.find(".pagination").length){for(s=0;s<q;s++){a("<li class='page' rel="+s+">"+(s+1)+"</li>").appendTo(o.find("ul"))}o.find(".page").live("click",function(x){x.preventDefault();var w=a(this);var y=a(this).attr("rel");b=y;o.find(".page").removeClass("active");a(this).addClass("active");if(f.orientation=="vertical"&&f.transition=="slide"){(!Modernizr.csstransitions)?o.find(".screen").stop().animate({top:y*-(k+f.spacing)},f.duration):o.find(".screen").css({top:y*-(k+f.spacing)})}else{if(f.orientation=="horizontal"&&f.transition=="slide"){(!Modernizr.csstransitions)?o.find(".screen").stop().animate({left:y*-(j+f.spacing)},f.duration):o.find(".screen").css({left:y*-(j+f.spacing)})}}if(f.transition=="crossfade"){(o.find(".img-pane-b").length)?o.find(".img-pane-b").remove():false;a("<div/>").addClass("img-pane-b").css("background","url("+o.find(".thumb:eq("+y+") .small").attr("src").replace(/ /g,"%20").replace(/'/g,"%27").replace("(","%28").replace(")","%29")+") no-repeat 50% 50%").insertAfter(o.find(".img-pane-a"));o.find(".img-pane-a").fadeOut(f.duration,function(){o.find(".img-pane-a").remove();o.find(".img-pane-b").removeClass("img-pane-b").addClass("img-pane-a")})}if(f.title==true){o.find(".info-pane h2").html(o.find(".thumb img:eq("+y+")").attr("title"))}if(f.desc==true){o.find(".info-pane span").html(o.find(".thumb img:eq("+y+")").attr("desc"))}if(o.find(".frame").length){o.find(".frame").click(function(){location.href=o.find(".item:eq("+y+")").attr("rel")})}var v=w.position();if(o.find(".pointer").length){if(f.orientation=="vertical"){(a.browser.msie)?o.find(".pointer").stop().animate({top:(v.top+(w.height()/2))},500):o.find(".pointer").css({top:(v.top+(w.height()/2))})}else{(a.browser.msie)?o.find(".pointer").stop().animate({left:(v.left+(w.width()/2))},500):o.find(".pointer").css({left:(v.left+(w.width()/2))})}}});if(f.divider==true){o.find(".page + .page").before(a('<li class="divider">-</li>'))}o.find(".pagination").each(function(){if(a(".page",this).length==1){a(this).hide();o.find(".next,.prev").hide()}})}o.find(".thumb:first").click();if(f.transition=="crossfade"){o.find(".screen").hide();a("<div/>").addClass("img-pane-a").insertAfter(o.find(".screen")).css("background","url("+o.find(".thumb:eq(0) .small").attr("src").replace(/ /g,"%20").replace(/'/g,"%27").replace("(","%28").replace(")","%29")+") no-repeat 50% 50%")}}this.each(function(){d(a(this))});return this}})(jQuery);